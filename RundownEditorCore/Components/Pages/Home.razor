@page "/"
@using System.Text.Json;
@inject IHttpClientFactory ClientFactory

<PageTitle>Home</PageTitle>

<h1>Hello, world!</h1>

<p>Indsæt tekst til teleprompter</p>
<textarea @bind="teleprompterText"></textarea>

<button role="button" @onclick="SaveText">Gem</button>

@code {
    private string teleprompterText { get; set; }

    private async Task SaveText()
    {
        var client = ClientFactory.CreateClient("TemplatesAPI");

        // Opret et objekt med de data, der skal sendes
        var teleprompterTest = new
        {
            teleprompterTestId = 0,
            text = teleprompterText
        };

        // Serialiser objektet til JSON
        var jsonContent = JsonSerializer.Serialize(teleprompterTest);

        // Opret JSON-indholdet til HTTP POST-requesten
        var content = new StringContent(jsonContent, System.Text.Encoding.UTF8, "application/json");

        // Send POST-requesten til API'en
        var response = await client.PostAsync("teleprompter/telepromptertests/create", content);

        if (response.IsSuccessStatusCode)
        {
            Console.WriteLine("Tekst gemt succesfuldt!");
        }
        else
        {
            Console.WriteLine($"Fejl ved gemning: {response.StatusCode}");
        }
    }

}
